{"version":3,"sources":["components/Dialogs/Dialogs.module.css","components/Dialogs/DialogItem/DialogItem.module.css","components/Dialogs/Message/Message.module.css","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js","components/Dialogs/DialogItem/DialogItem.js","components/Dialogs/Message/Messages.js","components/Dialogs/Dialogs.js","components/Dialogs/DialogsContainer.js"],"names":["module","exports","_createForOfIteratorHelper","o","allowArrayLike","it","Symbol","iterator","Array","isArray","unsupportedIterableToArray","length","i","F","s","n","done","value","e","_e","f","TypeError","err","normalCompletion","didErr","step","next","_e2","DialogItem","props","className","path","id","dialog","selectedItem","to","src","photo","alt","name","MessageContainer","this","getMessage","interlocutor","userId","isOwner","interlocutorPhoto","photoURL","message","interlocutorName","displayName","React","Component","Messages","console","log","divRef","useRef","useEffect","current","scrollIntoView","behavior","messageElem","reverse","map","item","elem","message_rigth","message_left","message__item","message__avatar","messageName","message__text","push","ref","AddNewMessageFormRedux","onSubmit","data","sendMessage","newMessage","ownerName","ownerPhoto","maxLength50","maxLengthCreator","reduxForm","form","handleSubmit","Field","component","Textarea","placeholder","validate","required","connect","state","auth","users","userPage","photoOwner","dialogsPage","messageData","Dialogs","followers","followingInUserId","j","dialogsElements","d","location","pathname","interlocutorId","slice","interlocutorIndex","findIndex","dialogs","dialogsItems","DialogsContainer","getAllUsers","getFollowers","compose","dialogsData","messageBody","newMessageBody","getFollowingInUserId","withRouter","withAuthRedirect"],"mappings":"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","file":"static/js/3.2b052868.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"dialogs\":\"Dialogs_dialogs__1Dcow\",\"dialogsItems\":\"Dialogs_dialogsItems__Lnmka\",\"dialog\":\"Dialogs_dialog__2rlRZ\",\"messages\":\"Dialogs_messages__38Mk_\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"dialogs\":\"DialogItem_dialogs__1Ogsw\",\"dialogsItems\":\"DialogItem_dialogsItems__16DK3\",\"dialog\":\"DialogItem_dialog__oHWe6\",\"messages\":\"DialogItem_messages__1aLd7\",\"selectedItem\":\"DialogItem_selectedItem__3K81j\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"dialogs\":\"Message_dialogs__TZWUb\",\"dialogsItems\":\"Message_dialogsItems__1vPxM\",\"dialog\":\"Message_dialog__3wqyg\",\"messages\":\"Message_messages__2akbG\",\"message_rigth\":\"Message_message_rigth__1X4m5\",\"message_left\":\"Message_message_left__2efCH\",\"message__avatar\":\"Message_message__avatar__2wyDT\",\"messageName\":\"Message_messageName__2OJIF\",\"message__item\":\"Message_message__item__2ycCy\",\"message__text\":\"Message_message__text__1T0oB\"};","import unsupportedIterableToArray from \"@babel/runtime/helpers/esm/unsupportedIterableToArray\";\nexport default function _createForOfIteratorHelper(o, allowArrayLike) {\n  var it;\n\n  if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) {\n    if (Array.isArray(o) || (it = unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n      if (it) o = it;\n      var i = 0;\n\n      var F = function F() {};\n\n      return {\n        s: F,\n        n: function n() {\n          if (i >= o.length) return {\n            done: true\n          };\n          return {\n            done: false,\n            value: o[i++]\n          };\n        },\n        e: function e(_e) {\n          throw _e;\n        },\n        f: F\n      };\n    }\n\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  var normalCompletion = true,\n      didErr = false,\n      err;\n  return {\n    s: function s() {\n      it = o[Symbol.iterator]();\n    },\n    n: function n() {\n      var step = it.next();\n      normalCompletion = step.done;\n      return step;\n    },\n    e: function e(_e2) {\n      didErr = true;\n      err = _e2;\n    },\n    f: function f() {\n      try {\n        if (!normalCompletion && it[\"return\"] != null) it[\"return\"]();\n      } finally {\n        if (didErr) throw err;\n      }\n    }\n  };\n}","import React from \"react\";\nimport s from \"./DialogItem.module.css\";\nimport { NavLink } from \"react-router-dom\";\nconst DialogItem = (props) => {\n  return (\n    <div className={props.path == `/Dialogs/${props.id}` ? s.dialog + \" \" + s.selectedItem : s.dialog}>\n      <NavLink to={\"/Dialogs/\" + props.id}>\n        <div><img src={props.photo} alt=\"icon\" />{props.name}</div>\n      </NavLink>\n    </div>\n  );\n};\nexport default DialogItem;","import React from \"react\";\nimport s from \"./Message.module.css\";\nimport { Field, reduxForm } from \"redux-form\";\nimport { maxLengthCreator, required } from \"../../utils/validation/FormValid\";\nimport { Textarea } from \"../../common/FormControl/FormControl\";\nimport { connect } from \"react-redux\";\nimport {\n  sendMessage,\n  getMessage\n} from \"../../../redux/dialogs-reducer\";\nimport { useEffect } from \"react\";\nimport { useRef } from \"react\";\n\n\nclass MessageContainer extends React.Component {\n  componentDidMount() {\n    this.props.getMessage(this.props.interlocutor.userId, this.props.isOwner)\n  }\n  render() {\n    return <Messages props={this.props}\n      interlocutorPhoto={this.props.interlocutor.photoURL}\n      message={this.props.message[this.props.interlocutor.userId]}\n      interlocutorName={this.props.interlocutor.name ? this.props.interlocutor.name : this.props.interlocutor.displayName}\n    />\n  }\n}\nlet mapStateToProps = (state) => {\n  return {\n    isOwner: state.auth.isOwner,\n    users: state.userPage.users,\n    ownerName: state.auth.displayName,\n    ownerPhoto: state.auth.photoOwner,\n    message: state.dialogsPage.messageData\n  };\n};\n// interlocutorPhoto: state.userPage.users.findIndex((item)=>{item.userId === this.props.uid})\n\n\nconst Messages = ({ props }) => {\n  console.log(props);\n  const divRef = useRef(null);\n\n  useEffect(() => {\n\n    divRef.current.scrollIntoView({ behavior: 'smooth' });\n  });\n  // useEffect(() => {\n  //   props.getMessage(props.interlocutor.userId, props.isOwner)\n  // })\n  let onSubmit = (data) => {\n    console.log(props);\n    props.sendMessage(data.newMessage,\n      props.interlocutor.userId,\n      props.isOwner,\n      props.ownerName,\n      props.ownerPhoto\n    );\n  };\n  let messageElem = [];\n  if (props.message[props.interlocutor.userId] && props.message[props.interlocutor.userId].length > 0) {\n    console.log(props.message[props.interlocutor.userId]);\n    [...props.message[props.interlocutor.userId]].reverse().map((item) => {\n      let elem = <div className={item.userId === props.isOwner ? s.message_rigth : s.message_left}>\n        <div className={s.message__item}><img src={item.photoURL} alt=\"icon\" className={s.message__avatar} />\n          <p className={s.messageName}>{item.name}</p>\n        </div>\n        <div className={s.message__text}>\n          {item.message}\n        </div>\n      </div>\n      messageElem.push(elem)\n    })\n  } else {\n    messageElem.push(<div>\n      <h2>Вы еще не общались с {props.interlocutor.displayName}</h2>\n      <p>для начала поздаровайтесь с {props.interlocutor.displayName}</p>\n    </div>)\n  }\n\n  return <div className={s.dialog}>\n    {messageElem}\n    <div ref={divRef} />\n    <div><AddNewMessageFormRedux onSubmit={onSubmit} /></div>\n  </div>;\n};\nconst maxLength50 = maxLengthCreator(50);\nconst AddNewMessageForm = (props) => {\n  return (\n    <div>\n      <form onSubmit={props.handleSubmit}>\n        <Field\n          component={Textarea}\n          placeholder=\"Enter your message here\"\n          name=\"newMessage\"\n          validate={[required, maxLength50]}\n        />\n        <div>\n          <button>Send message</button>\n        </div>\n      </form>\n    </div>\n  );\n};\nconst AddNewMessageFormRedux = reduxForm({ form: \"newMessage\" })(\n  AddNewMessageForm\n);\n\nexport default connect(mapStateToProps, { sendMessage, getMessage })(MessageContainer);\n","import React, { useEffect } from \"react\";\nimport s from \"./Dialogs.module.css\";\nimport DialogItem from \"./DialogItem/DialogItem\";\n\nimport MessageContainer from \"./Message/Messages\";\n\n\n\nconst Dialogs = ({ props }) => {\n\n  // useEffect(() => {\n  //   if (props.users.length == 0) {\n  //     props.getAllUsers();\n  //     props.getFollowers(props.isOwner)\n  //   }\n\n  // });\n\n\n  let followers = [];\n  for (let i of props.followingInUserId) {\n    for (let j of props.users) {\n      if (i == j.userId) {\n        followers.push(j);\n      }\n    }\n  }\n\n  let dialogsElements = followers.map((d) => (\n    <DialogItem\n      photo={d.photoURL} name={d.displayName} id={d.userId} path={props.location.pathname} />\n  ));\n\n  let interlocutorId = props.location.pathname.slice(9);\n  let interlocutorIndex = props.users.findIndex((item) => {\n    if (item.userId === interlocutorId)\n      return item\n  });\n  let interlocutor = props.users[interlocutorIndex];\n  return (\n    <div className={s.dialogs}>\n      <div className={s.dialogsItems}>{dialogsElements}</div>\n      <div>{props.location.pathname === \"/Dialogs\" ?\n        <div>Выбирите диалог</div> :\n        <MessageContainer\n          interlocutor={interlocutor} />}\n      </div>\n    </div>\n  );\n};\n\n\nexport default Dialogs;\n","import React from \"react\";\nimport Dialogs from \"./Dialogs\";\nimport { getFollowingInUserId } from \"../../redux/user-selectors\";\nimport { getAllUsers, getFollowers } from \"../../redux/user-reducer\";\nimport { connect } from \"react-redux\";\nimport withAuthRedirect from \"../HOC/RedirectContainer\";\nimport { compose } from \"redux\";\nimport { withRouter } from \"react-router-dom\";\n\nlet mapStateToProps = (state) => {\n  return {\n    dialogsData: state.dialogsPage.dialogsData,\n    messageBody: state.dialogsPage.newMessageBody,\n    messageData: state.dialogsPage.messageData,\n    followingInUserId: getFollowingInUserId(state),\n    users: state.userPage.users,\n    isOwner: state.auth.isOwner\n  };\n};\n\nclass DialogsContainer extends React.Component {\n  componentDidMount() {\n    this.props.getAllUsers();\n    this.props.getFollowers(this.props.isOwner)\n  }\n  render() {\n    return <Dialogs props={this.props} />\n  }\n}\n\nexport default compose(\n  connect(mapStateToProps, { getFollowers, getAllUsers }),\n  withRouter,\n  withAuthRedirect\n)(DialogsContainer);\n// export const DialogsContainer = connect(mapStateToProps, mapDispatchToProps)(Dialogs);\n// let DialogsAuthRedirectContainer = withAuthRedirect(DialogsContainer);\n// export default DialogsAuthRedirectContainer;\n"],"sourceRoot":""}