(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[3],{330:function(e,s,t){e.exports={dialogs:"Dialogs_dialogs__1Dcow",dialogsItems:"Dialogs_dialogsItems__Lnmka",dialog:"Dialogs_dialog__2rlRZ",messages:"Dialogs_messages__38Mk_"}},331:function(e,s,t){e.exports={dialogs:"DialogItem_dialogs__1Ogsw",dialogsItems:"DialogItem_dialogsItems__16DK3",dialog:"DialogItem_dialog__oHWe6",messages:"DialogItem_messages__1aLd7",selectedItem:"DialogItem_selectedItem__3K81j"}},332:function(e,s,t){e.exports={dialogs:"Message_dialogs__TZWUb",dialogsItems:"Message_dialogsItems__1vPxM",dialog:"Message_dialog__3wqyg",messages:"Message_messages__2akbG",message_rigth:"Message_message_rigth__1X4m5",message_left:"Message_message_left__2efCH",message__avatar:"Message_message__avatar__2wyDT",messageName:"Message_messageName__2OJIF",message__item:"Message_message__item__2ycCy",message__text:"Message_message__text__1T0oB"}},333:function(e,s,t){"use strict";t.r(s);var a=t(30),o=t(31),r=t(33),n=t(32),i=t(1),c=t.n(i),l=t(88);function g(e,s){var t;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=Object(l.a)(e))||s&&e&&"number"===typeof e.length){t&&(e=t);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,n=!0,i=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return n=e.done,e},e:function(e){i=!0,r=e},f:function(){try{n||null==t.return||t.return()}finally{if(i)throw r}}}}var u=t(330),d=t.n(u),m=t(331),p=t.n(m),h=t(26),_=t(2),j=function(e){return Object(_.jsx)("div",{className:e.path=="/Dialogs/".concat(e.id)?p.a.dialog+" "+p.a.selectedItem:p.a.dialog,children:Object(_.jsx)(h.b,{to:"/Dialogs/"+e.id,children:Object(_.jsxs)("div",{children:[Object(_.jsx)("img",{src:e.photo,alt:"icon"}),e.name]})})})},b=t(42),f=t(332),O=t.n(f),v=t(327),x=t(326),y=t(115),I=t(46),w=t(15),D=t(157),M=function(e){Object(r.a)(t,e);var s=Object(n.a)(t);function t(){return Object(a.a)(this,t),s.apply(this,arguments)}return Object(o.a)(t,[{key:"componentDidMount",value:function(){this.props.getMessage(this.props.interlocutor.userId,this.props.isOwner)}},{key:"componentDidUpdate",value:function(e){e.path!=this.props.path&&this.props.getMessage(this.props.interlocutor.userId,this.props.isOwner)}},{key:"render",value:function(){return Object(_.jsx)(N,{props:this.props,interlocutorPhoto:this.props.interlocutor.photoURL,message:this.props.message[this.props.interlocutor.userId],interlocutorName:this.props.interlocutor.name?this.props.interlocutor.name:this.props.interlocutor.displayName})}}]),t}(c.a.Component),N=function(e){var s=e.props;console.log(s);var t=Object(i.useRef)(null);Object(i.useEffect)((function(){t.current.scrollIntoView({behavior:"smooth"})}));var a=[];return s.message[s.interlocutor.userId]&&s.message[s.interlocutor.userId].length>0?(console.log(s.message[s.interlocutor.userId]),Object(b.a)(s.message[s.interlocutor.userId]).reverse().map((function(e){var t=Object(_.jsxs)("div",{className:e.userId===s.isOwner?O.a.message_rigth:O.a.message_left,children:[Object(_.jsxs)("div",{className:O.a.message__item,children:[Object(_.jsx)("img",{src:e.photoURL,alt:"icon",className:O.a.message__avatar}),Object(_.jsx)("p",{className:O.a.messageName,children:e.name})]}),Object(_.jsx)("div",{className:O.a.message__text,children:e.message})]});a.push(t)}))):a.push(Object(_.jsxs)("div",{children:[Object(_.jsxs)("h2",{children:["\u0412\u044b \u0435\u0449\u0435 \u043d\u0435 \u043e\u0431\u0449\u0430\u043b\u0438\u0441\u044c \u0441 ",s.interlocutor.displayName]}),Object(_.jsxs)("p",{children:["\u0434\u043b\u044f \u043d\u0430\u0447\u0430\u043b\u0430 \u043f\u043e\u0437\u0434\u0430\u0440\u043e\u0432\u0430\u0439\u0442\u0435\u0441\u044c \u0441 ",s.interlocutor.displayName]})]})),Object(_.jsxs)("div",{className:O.a.dialog,children:[a,Object(_.jsx)("div",{ref:t}),Object(_.jsx)("div",{children:Object(_.jsx)(P,{onSubmit:function(e){console.log(s),s.sendMessage(e.newMessage,s.interlocutor.userId,s.isOwner,s.ownerName,s.ownerPhoto)}})})]})},k=Object(y.a)(50),P=Object(x.a)({form:"newMessage"})((function(e){return Object(_.jsx)("div",{children:Object(_.jsxs)("form",{onSubmit:e.handleSubmit,children:[Object(_.jsx)(v.a,{component:I.b,placeholder:"Enter your message here",name:"newMessage",validate:[y.b,k]}),Object(_.jsx)("div",{children:Object(_.jsx)("button",{children:"Send message"})})]})})})),U=Object(w.b)((function(e){return{isOwner:e.auth.isOwner,users:e.userPage.users,ownerName:e.auth.displayName,ownerPhoto:e.auth.photoOwner,message:e.dialogsPage.messageData}}),{sendMessage:D.c,getMessage:D.b})(M),S=function(e){var s,t=e.props,a=[],o=g(t.followingInUserId);try{for(o.s();!(s=o.n()).done;){var r,n=s.value,i=g(t.users);try{for(i.s();!(r=i.n()).done;){var c=r.value;n==c.userId&&a.push(c)}}catch(h){i.e(h)}finally{i.f()}}}catch(h){o.e(h)}finally{o.f()}var l=a.map((function(e){return Object(_.jsx)(j,{photo:e.photoURL,name:e.displayName,id:e.userId,path:t.location.pathname})})),u=t.location.pathname.slice(9),m=t.users.findIndex((function(e){if(e.userId===u)return e})),p=t.users[m];return Object(_.jsxs)("div",{className:d.a.dialogs,children:[Object(_.jsx)("div",{className:d.a.dialogsItems,children:l}),Object(_.jsx)("div",{children:"/Dialogs"===t.location.pathname?Object(_.jsx)("div",{children:"\u0412\u044b\u0431\u0438\u0440\u0438\u0442\u0435 \u0434\u0438\u0430\u043b\u043e\u0433"}):Object(_.jsx)(U,{path:t.location.pathname,interlocutor:p})})]})},L=t(54),R=t(34),A=t(89),C=t(13),T=t(12),B=function(e){Object(r.a)(t,e);var s=Object(n.a)(t);function t(){return Object(a.a)(this,t),s.apply(this,arguments)}return Object(o.a)(t,[{key:"componentDidMount",value:function(){this.props.getAllUsers(),this.props.getFollowers(this.props.isOwner)}},{key:"render",value:function(){return Object(_.jsx)(S,{props:this.props})}}]),t}(c.a.Component);s.default=Object(C.d)(Object(w.b)((function(e){return{dialogsData:e.dialogsPage.dialogsData,messageBody:e.dialogsPage.newMessageBody,messageData:e.dialogsPage.messageData,followingInUserId:Object(L.c)(e),users:e.userPage.users,isOwner:e.auth.isOwner}}),{getFollowers:R.d,getAllUsers:R.c}),T.f,A.a)(B)}}]);
//# sourceMappingURL=3.dd6e6866.chunk.js.map